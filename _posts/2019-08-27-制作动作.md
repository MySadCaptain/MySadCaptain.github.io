---
title: 制作动作
comments: true
date: 2019-08-27
author: Matt
header-img: img/post-bg-desk.jpg
catalog: true
tags:
layout: post
---

LaunchBar的instant send功能使得LaunchBar可以直接对选中的文件运行脚本，不需要打开Terminal。

在LaunchBar中，按下快捷键 ⌥Option-⌘Command-E，新建一个动作，贴上如下脚本，这里脚本语言我选择的是Python。你也可以在[这里]((https://cl.ly/1p2l063Y1S3y))下载动作，直接添加到Launchbar。
```python
#!/usr/bin/env python
#
LaunchBar Action Script
#
import sys
import subprocess as sp
import os
import json
import shutil

my_env = os.environ.copy()
my_env["PATH"] = "/usr/local/bin:" + my_env["PATH"]
Note: The first argument is the script's path

for arg in sys.argv[1:]:
        fileFolder = os.path.dirname(arg)
        new_file= os.path.basename(arg)
        my_command = ["soffice", "--convert-to", "pdf", arg, "--outdir", fileFolder]
        sp.check_output(my_command, env=my_env)
        my_command = ["osascript", "notification.scpt", new_file, "Conversion Finished"]
        sp.check_output(my_command, env=my_env)

my_command = ["osascript", "done.scpt", "All Finished!"]
sp.check_output(my_command, env=my_env)
```

`for arg in sys.argv[1:]:`之前的代码负责导入库和声明环境变量，`for arg in sys.argv[1:]:`之后是针对选中的每一个文件进行如下操作。
值得注意的两条命令是
`my_command = ["soffice", "--convert-to", "pdf", arg, "--outdir", fileFolder] `
和
`my_command = ["osascript", "notification.scpt", new_file, "Conversion Finished"]`
前者是格式转换的命令，注意这里加了 `"--outdir", fileFolder `来指明输出的目录为所选文件所在目录
后者负责为每一个完成的文件发送通知

这个动作到这里就制作完成了，操作起来也很简单
1. 选中文件
2. 长按“CMD+space”通过intant send功能发送到LaunchBar
3. 输入“convert to pdf”，一般输入前几个字母就可以匹配了

如视频中所展示的，整个过程不到2秒，可以将格式各异的Office文件统一转换为PDF
